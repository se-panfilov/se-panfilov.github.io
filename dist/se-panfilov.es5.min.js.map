{"version":3,"sources":["se-panfilov.es5.js"],"names":["initHeader","width","window","innerWidth","height","innerHeight","target","x","y","largeHeader","document","getElementById","style","canvas","ctx","getContext","points","px","Math","random","py","p","originX","originY","push","i","length","closest","p1","j","p2","placed","k","undefined","getDistance","c","Circle","circle","addListeners","addEventListener","mouseMove","scrollCheck","resize","e","posx","posy","pageX","pageY","clientX","clientY","body","scrollLeft","documentElement","scrollTop","animateHeader","initAnimation","animate","shiftPoint","clearRect","abs","active","drawLines","draw","requestAnimationFrame","TweenLite","to","ease","Circ","easeInOut","onComplete","beginPath","moveTo","lineTo","strokeStyle","stroke","pos","rad","color","_this","this","radius","arc","PI","fillStyle","fill","pow"],"mappings":"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","file":"se-panfilov.es5.min.js","sourcesContent":["(function() {\n\n  var width, height, largeHeader, canvas, ctx, points, target, animateHeader = true;\n\n  // Main\n  initHeader();\n  initAnimation();\n  addListeners();\n\n  function initHeader() {\n    width = window.innerWidth;\n    height = window.innerHeight;\n    target = {x: width/2, y: height/2};\n\n    largeHeader = document.getElementById('large-header');\n    largeHeader.style.height = height+'px';\n\n    canvas = document.getElementById('demo-canvas');\n    canvas.width = width;\n    canvas.height = height;\n    ctx = canvas.getContext('2d');\n\n    // create points\n    points = [];\n    for(var x = 0; x < width; x = x + width/20) {\n      for(var y = 0; y < height; y = y + height/20) {\n        var px = x + Math.random()*width/20;\n        var py = y + Math.random()*height/20;\n        var p = {x: px, originX: px, y: py, originY: py };\n        points.push(p);\n      }\n    }\n\n    // for each point find the 5 closest points\n    for(var i = 0; i < points.length; i++) {\n      var closest = [];\n      var p1 = points[i];\n      for(var j = 0; j < points.length; j++) {\n        var p2 = points[j]\n        if(!(p1 == p2)) {\n          var placed = false;\n          for(var k = 0; k < 5; k++) {\n            if(!placed) {\n              if(closest[k] == undefined) {\n                closest[k] = p2;\n                placed = true;\n              }\n            }\n          }\n\n          for(var k = 0; k < 5; k++) {\n            if(!placed) {\n              if(getDistance(p1, p2) < getDistance(p1, closest[k])) {\n                closest[k] = p2;\n                placed = true;\n              }\n            }\n          }\n        }\n      }\n      p1.closest = closest;\n    }\n\n    // assign a circle to each point\n    for(var i in points) {\n      var c = new Circle(points[i], 2+Math.random()*2, 'rgba(255,255,255,0.3)');\n      points[i].circle = c;\n    }\n  }\n\n  // Event handling\n  function addListeners() {\n    if(!('ontouchstart' in window)) {\n      window.addEventListener('mousemove', mouseMove);\n    }\n    window.addEventListener('scroll', scrollCheck);\n    window.addEventListener('resize', resize);\n  }\n\n  function mouseMove(e) {\n    var posx = posy = 0;\n    if (e.pageX || e.pageY) {\n      posx = e.pageX;\n      posy = e.pageY;\n    }\n    else if (e.clientX || e.clientY)    {\n      posx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\n      posy = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\n    }\n    target.x = posx;\n    target.y = posy;\n  }\n\n  function scrollCheck() {\n    if(document.body.scrollTop > height) animateHeader = false;\n    else animateHeader = true;\n  }\n\n  function resize() {\n    width = window.innerWidth;\n    height = window.innerHeight;\n    largeHeader.style.height = height+'px';\n    canvas.width = width;\n    canvas.height = height;\n  }\n\n  // animation\n  function initAnimation() {\n    animate();\n    for(var i in points) {\n      shiftPoint(points[i]);\n    }\n  }\n\n  function animate() {\n    if(animateHeader) {\n      ctx.clearRect(0,0,width,height);\n      for(var i in points) {\n        // detect points in range\n        if(Math.abs(getDistance(target, points[i])) < 4000) {\n          points[i].active = 0.3;\n          points[i].circle.active = 0.6;\n        } else if(Math.abs(getDistance(target, points[i])) < 20000) {\n          points[i].active = 0.1;\n          points[i].circle.active = 0.3;\n        } else if(Math.abs(getDistance(target, points[i])) < 40000) {\n          points[i].active = 0.02;\n          points[i].circle.active = 0.1;\n        } else {\n          points[i].active = 0;\n          points[i].circle.active = 0;\n        }\n\n        drawLines(points[i]);\n        points[i].circle.draw();\n      }\n    }\n    requestAnimationFrame(animate);\n  }\n\n  function shiftPoint(p) {\n    TweenLite.to(p, 1+1*Math.random(), {x:p.originX-50+Math.random()*100,\n      y: p.originY-50+Math.random()*100, ease:Circ.easeInOut,\n      onComplete: function() {\n        shiftPoint(p);\n      }});\n  }\n\n  // Canvas manipulation\n  function drawLines(p) {\n    if(!p.active) return;\n    for(var i in p.closest) {\n      ctx.beginPath();\n      ctx.moveTo(p.x, p.y);\n      ctx.lineTo(p.closest[i].x, p.closest[i].y);\n      ctx.strokeStyle = 'rgba(156,217,249,'+ p.active+')';\n      ctx.stroke();\n    }\n  }\n\n  function Circle(pos,rad,color) {\n    var _this = this;\n\n    // constructor\n    (function() {\n      _this.pos = pos || null;\n      _this.radius = rad || null;\n      _this.color = color || null;\n    })();\n\n    this.draw = function() {\n      if(!_this.active) return;\n      ctx.beginPath();\n      ctx.arc(_this.pos.x, _this.pos.y, _this.radius, 0, 2 * Math.PI, false);\n      ctx.fillStyle = 'rgba(156,217,249,'+ _this.active+')';\n      ctx.fill();\n    };\n  }\n\n  // Util\n  function getDistance(p1, p2) {\n    return Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2);\n  }\n\n})();"]}